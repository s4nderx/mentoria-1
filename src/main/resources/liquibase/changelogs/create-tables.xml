<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd
http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

    <changeSet id="0" author="phellipe.sander">
        <sql>
            CREATE TABLE tb_category (id int8 GENERATED BY DEFAULT AS IDENTITY,
                                      created_at TIMESTAMP WITHOUT TIME ZONE,
                                      name varchar(255),
                                      updated_at TIMESTAMP WITHOUT TIME ZONE,
                                      PRIMARY KEY (id));


            CREATE TABLE tb_product (id int8 GENERATED BY DEFAULT AS IDENTITY,
                                     created_at TIMESTAMP WITHOUT TIME ZONE NOT NULL,
                                     name varchar(255),
                                     price numeric(19, 2),
                                     updated_at TIMESTAMP WITHOUT TIME ZONE,
                                     PRIMARY KEY (id));


            CREATE TABLE tb_product_category (product_id int8 NOT NULL,
                                              category_id int8 NOT NULL,
                                              PRIMARY KEY (product_id,
                                                           category_id));


            ALTER TABLE IF EXISTS tb_product_category ADD CONSTRAINT FK5r4sbavb4nkd9xpl0f095qs2a
                FOREIGN KEY (category_id) REFERENCES tb_category;


            ALTER TABLE IF EXISTS tb_product_category ADD CONSTRAINT FKgbof0jclmaf8wn2alsoexxq3u
                FOREIGN KEY (product_id) REFERENCES tb_product;
        </sql>
    </changeSet>

<!--    <changeSet id="0" author="phellipe.sander">-->

<!--        <preConditions>-->
<!--            <not>-->
<!--                <tableExists tableName="TB_CATEGORY" />-->
<!--            </not>-->
<!--        </preConditions>-->

<!--        <createTable tableName="TB_CATEGORY">-->
<!--            <column autoIncrement="true" name="id" type="BIGINT">-->
<!--                <constraints primaryKey="true" nullable="false"/>-->
<!--            </column>-->
<!--            <column name="name" type="VARCHAR(255)">-->
<!--                <constraints nullable="false"/>-->
<!--            </column>-->
<!--            <column name="created_at" type="timestamp"/>-->
<!--            <column name="updated_at" type="timestamp"/>-->
<!--        </createTable>-->

<!--        <createIndex tableName="TB_CATEGORY" indexName="index_category">-->
<!--            <column name="id" />-->
<!--        </createIndex>-->

<!--    </changeSet>-->

<!--    <changeSet id="1" author="phellipe.sander">-->
<!--        <preConditions>-->
<!--            <not>-->
<!--                <tableExists tableName="TB_PRODUCT" />-->
<!--            </not>-->
<!--        </preConditions>-->

<!--        <createTable tableName="TB_PRODUCT">-->
<!--            <column name="id" autoIncrement="true"  type="BIGINT">-->
<!--                <constraints primaryKey="true" nullable="false"/>-->
<!--            </column>-->
<!--            <column name="name" type="VARCHAR(255)">-->
<!--                <constraints nullable="false"/>-->
<!--            </column>-->
<!--            <column name="price" type="DECIMAL(19,2)">-->
<!--                <constraints nullable="false"/>-->
<!--            </column>-->
<!--            <column name="created_at" type="timestamp"/>-->
<!--            <column name="updated_at" type="timestamp"/>-->
<!--        </createTable>-->

<!--        <createIndex tableName="TB_PRODUCT" indexName="index_product">-->
<!--            <column name="id" />-->
<!--        </createIndex>-->

<!--    </changeSet>-->

<!--    <changeSet id="2" author="phellipe.sander">-->
<!--        <preConditions>-->
<!--            <not>-->
<!--                <tableExists tableName="TB_PRODUCT_CATEGORY" />-->
<!--            </not>-->
<!--        </preConditions>-->

<!--        <createTable tableName="TB_PRODUCT_CATEGORY">-->
<!--            <column name="CATEGORY_ID" type="BIGINT">-->
<!--                <constraints foreignKeyName="fk__category_id" references="TB_CATEGORY(id)" nullable="false"/>-->
<!--            </column>-->
<!--            <column name="PRODUCT_ID" type="BIGINT">-->
<!--                <constraints foreignKeyName="fk__product_id" references="TB_PRODUCT(id)" nullable="false"/>-->
<!--            </column>-->
<!--        </createTable>-->

<!--        <createIndex tableName="TB_PRODUCT_CATEGORY" indexName="index_fk__category">-->
<!--            <column name="CATEGORY_ID" />-->
<!--        </createIndex>-->
<!--        <createIndex tableName="TB_PRODUCT_CATEGORY" indexName="index_fk__product">-->
<!--            <column name="PRODUCT_ID" />-->
<!--        </createIndex>-->
<!--    </changeSet>-->
</databaseChangeLog>